# Machine Learning-Powered Trading Strategy 📈

This project implements and compares two stock trading strategies: a **Manual Strategy** based on technical indicator rules and a **Strategy Learner** that uses machine learning to autonomously develop its own trading policy. The primary goal is to rigorously evaluate the performance of a human-designed approach against an ML-driven one using specific, controlled experimental parameters.

This was developed as the capstone project for the Georgia Tech course, [CS7646: Machine Learning for Trading](https://omscs.gatech.edu/cs-7646-machine-learning-trading).

-----

## Table of Contents

  - [Project Overview](https://github.com/yirong-t/Trading-strategy---Machine-Learning/tree/main?tab=readme-ov-file#project-overview-)
  - [Key Features](https://github.com/yirong-t/Trading-strategy---Machine-Learning/edit/main/README.md#project-structure-)
  - [Performance Highlights](https://github.com/yirong-t/Trading-strategy---Machine-Learning/edit/main/README.md#performance-highlights-)
  - [Project Structure](https://github.com/yirong-t/Trading-strategy---Machine-Learning/edit/main/README.md#project-structure-)
  - [Experiments & Methodology](https://github.com/yirong-t/Trading-strategy---Machine-Learning/edit/main/README.md#project-structure-)
  - [Technology Stack](https://github.com/yirong-t/Trading-strategy---Machine-Learning/edit/main/README.md#technology-stack-%EF%B8%8F)
  - [How to Run](https://github.com/yirong-t/Trading-strategy---Machine-Learning/edit/main/README.md#how-to-run-)

-----

## Project Overview 💡

The project's core is a head-to-head comparison between human intuition and machine learning in the context of stock trading.

1.  **`ManualStrategy`**: A traditional, rules-based trading algorithm. I defined specific entry and exit signals based on a combination of **[Indicator 1, MACD Histogram ]**, **[Indicator 2, RSI]**, and **[Indicator 3,Percent B (Bollinger Bands)]**. This represents a "human-defined logic" approach, tuned on in-sample data.

2.  **`StrategyLearner`**: A smart agent that uses a **[Ensemble learner(bag learner) with random forest learner (RT learner)]** to learn a trading policy from the same set of indicators. It's trained on an "in-sample" period and then tested "out-of-sample" to evaluate its ability to generalize to new, unseen data.

Two distinct experiments were conducted to compare the strategies and analyze the learner's sensitivity to market conditions.

-----

## Key Features ✨

  * **Dual-Strategy Framework**: Implements both manual and ML-based trading agents for direct, apples-to-apples comparison.
  * **Structured Experimentation**: Features two detailed experiments to compare strategies and analyze the impact of transaction costs.
  * **Modular Codebase**: Reuses learners (`RTLearner`, `BagLearner`, etc.) and modules from previous work in a clean, organized structure.
  * **Rigorous Backtesting**: Adheres to strict in-sample/out-of-sample periods, transaction cost modeling, and benchmark comparison for robust evaluation.

-----

## Performance Highlights 📊

The primary comparison (`Experiment 1`) was conducted on **JPMorgan Chase & Co. (JPM)** stock. The chart below shows the normalized out-of-sample performance of both strategies against the benchmark.

*Out-of-sample portfolio performance for `ManualStrategy`, `StrategyLearner`, and Benchmark.*

The `StrategyLearner` was able to **[briefly describe the outcome, e.g., significantly outperform both the manual strategy and the benchmark, demonstrating its ability to adapt and find profitable patterns]**. Detailed performance metrics (cumulative return, Sharpe ratio, etc.) are generated by the project scripts.

-----

## Project Structure 📁

The project is organized with a clear separation of strategies, learners, experiments, and utilities.

```
.
├── testproject.py            # Main entry point to run all experiments
├── experiment1.py            # Compares ManualStrategy vs. StrategyLearner
├── experiment2.py            # Analyzes the effect of market impact
├── ManualStrategy.py         # Implementation of the rule-based strategy
├── StrategyLearner.py        # Wrapper for the ML-based strategy
├── indicators.py             # All technical indicator functions
├── marketsimcode.py          # Market simulator for calculating portfolio stats
├── learners/                 # Directory for ML algorithm code
│   ├── RTLearner.py
│   ├── BagLearner.py
│   └── ... (and other learners like DTLearner, QLearner)
└── analysis_report.pdf       # The final generated report with charts and tables
```

-----

## Experiments & Methodology 📝

All experiments adhere to the following environment rules:

  * **Stock Symbol**: `JPM`
  * **In-Sample Period**: January 1, 2008 – December 31, 2009
  * **Out-of-Sample Period**: January 1, 2010 – December 31, 2011
  * **Starting Portfolio Value**: $100,000
  * **Allowed Positions**: +1000 shares (LONG), -1000 shares (SHORT), or 0 shares (CASH)
  * **Transaction Costs**: Commission: $9.95, Market Impact: 0.005
  * **Benchmark**: Buying 1000 shares of JPM on the first day and holding.

### Experiment 1: Manual vs. Machine Learning Strategy

This experiment directly compares the performance of the `ManualStrategy` against the `StrategyLearner` and the benchmark. The script generates two charts: one for the in-sample period and one for the out-of-sample period, showing the normalized portfolio value of all three. It also produces tables with key performance metrics (cumulative return, mean/STD of daily returns).



### Experiment 2: Analyzing the Effect of Market Impact

This experiment investigates how the `StrategyLearner`'s behavior changes as market impact costs are varied. By running the learner on the in-sample data with different `impact` values (e.g., 0.0, 0.005, 0.02), I analyze how its trading frequency and overall returns are affected. This demonstrates the learner's ability to adapt its policy to changing transaction costs, a crucial feature for real-world application.

-----

## Technology Stack 🛠️

  * **Language**: Python 3.8+
  * **Core Libraries**: Pandas, NumPy, scikit-learn
  * **Visualization**: Matplotlib

-----

## How to Run 🚀

**1. Clone the repository:**

```bash
git clone https://github.com/[Your-Username]/[your-repo-name].git
cd [your-repo-name]
```

**2. Install dependencies:**

```bash
pip install -r requirements.txt
```

**3. Run the Full Project:**
The `testproject.py` script is the main entry point and will execute all necessary components, including training the learner and running both experiments to generate all charts and tables for the final report.

Execute the following command from the project's root directory:

```bash
python testproject.py
```

*(Note: Per project requirements, this script internally handles the necessary `PYTHONPATH` adjustments to correctly import modules from subdirectories.)*

Upon completion, all generated charts and analysis tables will be available for review in the project directory.
